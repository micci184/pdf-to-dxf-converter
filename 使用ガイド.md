# PDF to DXF 変換ツール 使用ガイド

## 📋 バージョン選択ガイド

### 🚀 ultra_high_precision_main.py（超高精度版）

**推奨用途: 最高品質が必要な重要図面**

```bash
python ultra_high_precision_main.py --input "図面.pdf" --scale 100 --visualization
```

**特徴:**

- 解像度: 600dpi
- 検出精度: 最高（50,000 本以上）
- 処理時間: 中〜長時間
- ファイルサイズ: 中程度
- 手書き文字認識: 高精度（50 個以上）

**適用場面:**

- 重要な建築図面
- 詳細な設計図
- 精密な測定が必要な図面
- 品質優先の場合

---

### ⚡ optimized_ultra_main.py（最適化超高精度版）

**推奨用途: 品質と実用性のバランス重視**

```bash
python optimized_ultra_main.py --input "図面.pdf" --scale 100 --visualization
```

**特徴:**

- 解像度: 500dpi
- 検出精度: 非常に高い（70,000 本以上、重複除去済み）
- 処理時間: 中程度
- ファイルサイズ: 大（重複除去により実用的）
- 重複除去: 高度なアルゴリズム

**適用場面:**

- 日常的な図面変換
- 実用性重視の場合
- ファイルサイズを抑えたい場合
- 重複線分が多い図面

---

### 🎨 png_level_main.py（改良 PNG 品質版）

**推奨用途: 高速処理・軽量変換**

```bash
python png_level_main.py --input "図面.pdf" --scale 100
```

**特徴:**

- 解像度: 400dpi
- 検出精度: 高い（30,000 本以上）
- 処理時間: 高速
- ファイルサイズ: 軽量
- 手書き文字認識: 対応（23 個以上）

**適用場面:**

- 大量の図面を一括変換
- 速度重視の場合
- 軽量なファイルが必要
- 基本的な変換で十分な場合

## 🎯 用途別推奨バージョン

### 建築設計事務所

```bash
# 重要図面
python ultra_high_precision_main.py --input "設計図.pdf" --scale 100 -v

# 日常図面
python optimized_ultra_main.py --input "検討図.pdf" --scale 100 -v
```

### 工事現場

```bash
# 現場図面（速度重視）
python png_level_main.py --input "現場図.pdf" --scale 100
```

### CAD オペレーター

```bash
# 精密変換（品質重視）
python ultra_high_precision_main.py --input "詳細図.pdf" --scale 50 -v
```

## 📊 パフォーマンス比較

| 項目               | 超高精度版 | 最適化版   | PNG 品質版 |
| ------------------ | ---------- | ---------- | ---------- |
| **検出精度**       | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐   |
| **処理速度**       | ⭐⭐⭐     | ⭐⭐⭐⭐   | ⭐⭐⭐⭐⭐ |
| **ファイルサイズ** | ⭐⭐⭐     | ⭐⭐⭐⭐   | ⭐⭐⭐⭐⭐ |
| **メモリ使用量**   | ⭐⭐       | ⭐⭐⭐     | ⭐⭐⭐⭐⭐ |
| **実用性**         | ⭐⭐⭐⭐   | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐   |

## 🔧 パラメータ設定ガイド

### スケール設定

```bash
# 1:50図面の場合
--scale 50

# 1:100図面の場合
--scale 100

# 1:200図面の場合
--scale 200
```

### 可視化オプション

```bash
# 可視化画像を生成（推奨）
--visualization

# 可視化なし（高速処理）
（オプションなし）
```

## 🎨 出力ファイル例

### 超高精度版の出力例

```
20250612_1724_手書き【平面図(2階)】_ultra_precision.dxf
20250612_1724_手書き【平面図(2階)】_ultra_precision_vis.png
```

### 最適化版の出力例

```
20250612_1737_手書き【平面図(2階)】_optimized_ultra.dxf
20250612_1737_手書き【平面図(2階)】_optimized_ultra_vis.png
```

### PNG 品質版の出力例

```
20250612_1743_手書き【平面図(2階)】_png_level.dxf
```

## 🚀 実行コマンド例

### 基本実行

```bash
# 超高精度版
python ultra_high_precision_main.py -i "図面.pdf"

# 最適化版
python optimized_ultra_main.py -i "図面.pdf" -v

# PNG品質版
python png_level_main.py -i "図面.pdf"
```

### 詳細設定

```bash
# カスタム出力ファイル名
python ultra_high_precision_main.py -i "input.pdf" -o "custom_output.dxf" -s 100 -v

# スケール指定
python optimized_ultra_main.py -i "図面.pdf" --scale 50 --visualization

# 高速処理
python png_level_main.py --input "図面.pdf" --scale 100
```

## 🔍 結果の確認方法

### 1. 可視化画像の確認

生成された `*_vis.png` ファイルで検出結果を確認：

- **黒線**: 主要構造線
- **青線**: 青い線分
- **緑線**: 緑の線分
- **赤線**: 赤い線分
- **紫枠**: テキスト領域

### 2. DXF ファイルの確認

- AutoCAD、JW-CAD、FreeCAD などで開く
- レイヤー別に線分が分類されている
- 色別に線分が識別されている

### 3. ログ出力の確認

```
🔍 包括的色線検出: 青=25291本, 緑=12164本, 赤=10404本
📝 テキスト: 50個 (赤文字: 18個)
🎯 総線分数: 50932本
```

## ⚡ 高速処理のコツ

### 1. 適切なバージョン選択

```bash
# 大量処理の場合
python png_level_main.py -i "*.pdf"

# 1枚ずつ高品質
python ultra_high_precision_main.py -i "重要図面.pdf" -v
```

### 2. パラメータ最適化

```bash
# 可視化なしで高速化
python png_level_main.py -i "図面.pdf" --scale 200

# メモリ使用量削減
python optimized_ultra_main.py -i "図面.pdf" --scale 150
```

## 🎯 品質向上のコツ

### 1. 入力 PDF の品質向上

- スキャン解像度: 300dpi 以上推奨
- ファイル形式: PDF（ベクター形式推奨）
- コントラスト: 線がくっきり見える状態

### 2. 適切なスケール設定

```bash
# 詳細検出重視
--scale 50

# バランス重視
--scale 100

# 軽量化重視
--scale 200
```

### 3. バージョン組み合わせ

```bash
# 1回目: 高速確認
python png_level_main.py -i "図面.pdf"

# 2回目: 高精度変換
python ultra_high_precision_main.py -i "図面.pdf" -v
```

## 🔧 トラブルシューティング

### エラー対処法

#### メモリエラー

```bash
# 軽量版に変更
python png_level_main.py -i "図面.pdf"

# スケール値を上げる
--scale 200
```

#### 処理時間が長い

```bash
# 高速版に変更
python png_level_main.py -i "図面.pdf"

# 可視化を無効化
（--visualization オプションを除去）
```

#### 検出精度が低い

```bash
# 最高精度版に変更
python ultra_high_precision_main.py -i "図面.pdf" -v

# スケール値を下げる
--scale 50
```

## 📈 精度向上の実績

**従来版からの改善:**

- 線分検出数: **300-700 倍向上**
- 手書き文字認識: **大幅改善**
- 色線検出精度: **飛躍的向上**

**具体的数値:**

- 従来版: ~300 本 → 改良版: 30,000-70,000 本
- 赤文字認識: 0 個 → 改良版: 18-31 個
- 処理精度: 基本レベル → 実用レベル

---

## 🎉 まとめ

手書き図面の PDF 変換が劇的に改善されました！
用途に応じて適切なバージョンを選択し、高精度な変換をお楽しみください。
